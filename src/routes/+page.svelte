<script>
    import Like from "../img/like.png";
    import noLike from "../img/notLike.png";
    import { onMount } from "svelte";

    let posts = []; // 트래블로그 데이터 저장

    onMount(() => {
        loadPosts();
    });

    function loadPosts() {
        let storedPosts = JSON.parse(localStorage.getItem("posts")) || [];
        posts = storedPosts;
    }

    function isPostLiked(post) {
        const username = localStorage.getItem("username");
        return post.likedBy && post.likedBy.includes(username);
    }
</script>

<header>
    <div></div>
</header>
<!-- section 시작 -->
<section class="index">
    <div class="PopularTravel">
        <h2>인기 여행지</h2>
        <ul>
            <li><a href="../locationDetailSeoul" class="Seoul"><span>서울</span></a></li>
            <li><a href="../locationDetailBusan" class="Busan"><span>부산</span></a></li>
            <li><a href="../locationDetailJeju" class="Jeju"><span>제주</span></a></li>
            <li><a href="../locationDetailGangneung" class="Gangneung"><span>강릉</span></a></li>
        </ul>
        <ul>
            <li><a href="../locationDetailGunsan" class="Gunsan"><span>군산</span></a></li>
            <li><a href="../locationDetailGyeongju" class="Gyeongju"><span>경주</span></a></li>
            <li><a href="../locationDetailIncheon" class="Incheon"><span>인천</span></a></li>
            <li><a href="../locationDetailSuwon" class="Suwon"><span>수원</span></a></li>
        </ul>
        <ul>
            <li><a href="../locationDetailPohang" class="Pohang"><span>포항</span></a></li>
            <li><a href="../locationDetailUlsan" class="Ulsan"><span>울산</span></a></li>
            <li><a href="../locationDetailDaegu" class="Daegu"><span>대구</span></a></li>
            <li><a href="../locationDetailJeonju" class="Jeonju"><span>전주</span></a></li>
        </ul>
    </div>
    <div class="TravelLog uList">
        <h2>트래블로그</h2>
        <ul>
            {#each posts.slice(0, 6) as post}  <!-- 처음 6개만 선택 -->
            <li>
                <a href={`/travelLogDetail/${post.id}`}>
                    <img src={post.image || "https://placehold.co/200x200"} alt="여행지 사진">
                    <p>{post.title}</p>
                    <div class="like">
                        <span>작성자: {post.username}</span>
                        <span>
                            <img src={post.likedBy && post.likedBy.includes(localStorage.getItem("username")) ? Like : noLike}
                                 alt="좋아요" class="like-icon" data-liked={post.likedBy && post.likedBy.includes(localStorage.getItem("username"))}>
                        </span>
                    </div>
                </a>
            </li>
            {/each}
        </ul>
        <a href="/travelLog" class="indexBtn">트래블로그 더 보기</a>
    </div>
    <!-- <div class="TripMoment uList">
        <h2>트립 모먼트</h2>
        <ul>
            <li>
                <a href="">
                    <img src="https://placehold.co/200x200" alt="여행지 사진">
                    <p>작성자</p>
                    <div class="like">
                        <span>지역명</span>
                        <span><img src={noLike} alt="좋아요" class="like-icon" data-liked="false"></span>
                    </div>
                </a>
            </li>
            <li>
                <a href="">
                    <img src="https://placehold.co/200x200" alt="여행지 사진">
                    <p>작성자</p>
                    <div class="like">
                        <span>지역명</span>
                        <span><img src={noLike} alt="좋아요" class="like-icon" data-liked="false"></span>
                    </div>
                </a>
            </li>
            <li>
                <a href="">
                    <img src="https://placehold.co/200x200" alt="여행지 사진">
                    <p>작성자</p>
                    <div class="like">
                        <span>지역명</span> 
                        <span><img src={noLike} alt="좋아요" class="like-icon" data-liked="false"></span>
                    </div>
                </a>
            </li>
            <li>
                <a href="">
                    <img src="https://placehold.co/200x200" alt="여행지 사진">
                    <p>작성자</p>
                    <div class="like">
                        <span>지역명</span>
                        <span><img src={Like} alt="좋아요" class="like-icon" data-liked="true"></span>
                    </div>
                </a>
            </li>
        </ul>
        <a href="/tripMoment" class="indexBtn">트립 모먼트 더 보기</a>
    </div> -->
</section>